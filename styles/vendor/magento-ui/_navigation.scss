//
//  Navigation
//  _____________________________________________

// TODO put old var declarations back in

@mixin lib-main-navigation(
    $_nav__indent-side                       :  $_nav__indent-side                       ,
    $_nav-background-color                   :  $_nav-background-color                   ,
    $_nav-border                             :  $_nav-border                             ,
    $_nav-level0-font-size                   :  $_nav-level0-font-size                   ,
    $_nav-level0-font-weight                 :  $_nav-level0-font-weight                 ,
    $_nav-level0-item-line-height            :  $_nav-level0-item-line-height            ,
    $_nav-level0-item-margin                 :  $_nav-level0-item-margin                 ,
    $_nav-level0-item-padding                :  $_nav-level0-item-padding                ,
    $_nav-level0-text-transform              :  $_nav-level0-text-transform              ,

    $_nav-level0-item-background-color       : inherit,
    $_nav-level0-item-border                 : $_nav-level0-item-border,
    $_nav-level0-item-color                  : $_nav-level0-item-color,
    $_nav-level0-item-text-decoration        : $_nav-level0-item-text-decoration,

    $_nav-level0-item-background-color-active:  $_nav-level0-item-background-color-active,
    $_nav-level0-item__active__border-color  :  $_nav-level0-item__active__border-color  ,
    $_nav-level0-item__active__border-style  :  $_nav-level0-item__active__border-style  ,
    $_nav-level0-item__active__border-width  :  $_nav-level0-item__active__border-width  ,
    $_nav-level0-item-color-active           :  $_nav-level0-item-color-active           ,
    $_nav-level0-item-text-decoration-active :  $_nav-level0-item-text-decoration-active ,
    $_nav-level0-item-background-color-active : $navigation-level0-item__active__background,
    $_nav-level0-item__active__border-color   : $navigation-level0-item__active__border-color,
    $_nav-level0-item__active__border-style   : $navigation-level0-item__active__border-style,
    $_nav-level0-item__active__border-width   : $navigation-level0-item__active__border-width,
    $_nav-level0-item-color-active            : $navigation-level0-item__active__color,
    $_nav-level0-item-text-decoration-active  : $navigation-level0-item__active__text-decoration,

    $_submenu-background-color               :  $_submenu-background-color               ,
    $_submenu-border                         :  $_submenu-border                         ,
    $_submenu-font-size                      :  $_submenu-font-size                      ,
    $_submenu-font-weight                    :  $_submenu-font-weight                    ,
    $_submenu-line-height                    :  $_submenu-line-height                    ,
    $_submenu-item__padding-top              :  $_submenu-item__padding-top              ,
    $_submenu-item__padding-right            :  $_submenu-item__padding-right            ,
    $_submenu-item__padding-bottom           :  $_submenu-item__padding-bottom           ,
    $_submenu-item__padding-left             :  $_submenu-item__padding-left             ,
    $_submenu-background-color                : $submenu__background,
    $_submenu-border                          : $submenu__border,
    $_submenu-font-size                       : $submenu__font-size,
    $_submenu-font-weight                     : $submenu__font-weight,
    $_submenu-line-height                     : $submenu-item__line-height,
    $_submenu-item__padding-top               : $submenu__padding-top,
    $_submenu-item__padding-right             : $submenu__padding-right,
    $_submenu-item__padding-bottom            : $submenu__padding-bottom,
    $_submenu-item__padding-left              : $submenu__padding-left,

    $_submenu-item-background-color          :  $_submenu-item-background-color          ,
    $_submenu-item-border                    :  $_submenu-item-border                    ,
    $_submenu-item-color                     :  $_submenu-item-color                     ,
    $_submenu-item-text-decoration           :  $_submenu-item-text-decoration           ,
    $_submenu-item-background-color           : $submenu-item__background,
    $_submenu-item-border                     : $submenu-item__border,
    $_submenu-item-color                      : $submenu-item__color,
    $_submenu-item-text-decoration            : $submenu-item__text-decoration,

    $_submenu-item-background-color-active   :  $_submenu-item-background-color-active   ,
    $_submenu-item__active__border           :  $_submenu-item__active__border           ,
    $_submenu-item__active__border-color     :  $_submenu-item__active__border-color     ,
    $_submenu-item__active__border-style     :  $_submenu-item__active__border-style     ,
    $_submenu-item__active__border-width     :  $_submenu-item__active__border-width     ,
    $_submenu-item-color-active              :  $_submenu-item-color-active              ,
    $_submenu-item-text-decoration-active    :  $_submenu-item-text-decoration-active
    $_submenu-item-background-color-active    : $submenu-item__active__background,
    $_submenu-item__active__border            : $submenu-item__active__border,
    $_submenu-item__active__border-color      : $submenu-item__active__border-color,
    $_submenu-item__active__border-style      : $submenu-item__active__border-style,
    $_submenu-item__active__border-width      : $submenu-item__active__border-width,
    $_submenu-item-color-active               : $submenu-item__active__color,
    $_submenu-item-text-decoration-active     : $submenu-item__active__text-decoration
) {
    .navigation {
        @include lib-css(background, $_nav-background-color);
        @include lib-css(border, $_nav-border);
        box-sizing: border-box;

        ul {
            margin: 0;
            padding: 0;
        }

        li {
            margin: 0;
        }

        a {
            display: block;
            @include lib-css(padding, $_submenu-item__padding-top $_submenu-item__padding-right $_submenu-item__padding-bottom $_submenu-item__padding-left);
        }

        a,
        a:hover {
            @include lib-css(color, $_nav-level0-item-color);
            @include lib-css(text-decoration, $_nav-level0-item-text-decoration);
        }

        .level0 {
            @include lib-css(border-top, $_nav-level0-item-border);
            @include lib-font-size($_nav-level0-font-size);

            > .level-top {
                @include lib-css(background, $_nav-level0-item-background-color);
                @include lib-css(font-weight, $_nav-level0-font-weight);
                @include lib-css(line-height, $_nav-level0-item-line-height);
                @include lib-css(padding, $_nav-level0-item-padding);
                @include lib-css(text-transform, $_nav-level0-text-transform);
                word-wrap: break-word;
            }

            &.active {
                .all-category {
                    .ui-state-focus {
                        @include lib-css(background, $_nav-level0-item-background-color-active);
                        @include lib-css(border-color, $_nav-level0-item__active__border-color);
                        @include lib-css(border-style, $_nav-level0-item__active__border-style);
                        @include lib-css(border-width, $_nav-level0-item__active__border-width);
                        @include lib-css(color, $_nav-level0-item-color-active);
                        @include lib-css(padding-left, $_nav__indent-side - $_submenu-item__active__border);
                        @include lib-css(text-decoration, $_nav-level0-item-text-decoration-active);
                        display: inline-block;
                    }
                }
            }

            > .level1 {
                @include lib-css(font-weight, $font-weight__semibold);
            }

            &.active,
            &.has-active { // ToDo UI: remove "has_active" here, when mobile navigation default open state is implemented
                > a:not(.ui-state-active) {
                    @include lib-css(background, $_nav-level0-item-background-color-active);
                    @include lib-css(border-color, $_nav-level0-item__active__border-color);
                    @include lib-css(border-style, $_nav-level0-item__active__border-style);
                    @include lib-css(border-width, $_nav-level0-item__active__border-width);
                    @include lib-css(color, $_nav-level0-item-color-active);
                    @include lib-css(text-decoration, $_nav-level0-item-text-decoration-active);

                    span:not(.ui-menu-icon) {
                        @include lib-css(margin-left, -$_submenu-item__active__border);
                    }
                }
            }
        }

        li.level0 {
            &:last-child {
                @include lib-css(border-bottom, $_nav-level0-item-border);
            }
        }

        .submenu {
            > li {
                word-wrap: break-word;
            }

            &:not(:first-child) {
                @include lib-css(background, $_submenu-background-color);
                @include lib-css(border, $_submenu-border);
                @include lib-css(font-size, $_submenu-font-size);
                @include lib-css(font-weight, $_submenu-font-weight);
                @include lib-css(line-height, $_submenu-line-height);
                left: auto !important;
                overflow-x: hidden;
                padding: 0;
                position: relative;
                top: auto !important;
                transition: left 0.3s ease-out;

                > li {
                    > a {
                        @include lib-css(padding-left, $_nav__indent-side);
                    }

                    &:last-child {
                        margin-bottom: 0;
                    }
                }

                ul {
                    display: block;
                    @include lib-css(padding-left, $_submenu-item__padding-left);

                    > li {
                        margin: 0;

                        a {
                            @include lib-css(background, $_submenu-item-background-color);
                            @include lib-css(border, $_submenu-item-border);
                            @include lib-css(color, $_submenu-item-color);
                            @include lib-css(text-decoration, $_submenu-item-text-decoration);
                            display: block;
                            line-height: normal;
                        }
                    }
                }

                &.expanded {
                    display: block !important;
                    padding-right: 0;
                    top: 0 !important;
                }

                .active {
                    > a {
                        @include lib-css(background, $_submenu-item-background-color-active);
                        @include lib-css(border-color, $_submenu-item__active__border-color);
                        @include lib-css(border-style, $_submenu-item__active__border-style);
                        @include lib-css(border-width, $_submenu-item__active__border-width);
                        @include lib-css(color, $_submenu-item-color-active);
                        @include lib-css(padding-left, $_nav__indent-side - $_submenu-item__active__border);
                        @include lib-css(text-decoration, $_submenu-item-text-decoration-active);
                    }
                }

                .level1 {
                    &.active {
                        > a {
                            @include lib-css(padding-left, $_nav__indent-side - $_submenu-item__active__border);
                        }
                    }
                }
            }
        }
    }
}

//
//  Desktop
//  _____________________________________________

$desktop-nav-background-color                   : $color-gray94 !default;
$desktop-nav-border                             : none !default;
$desktop-nav-font-size                          : inherit !default;
$desktop-nav-font-weight                        : $font-weight__bold !default;

$desktop-nav-level0-item-line-height            : 53px !default;
$desktop-nav-level0-item-margin                 : 0 $indent__s 0 0 !default;
$desktop-nav-level0-item-padding                : 0 12px !default;

$desktop-nav-level0-item-background-color       : inherit !default;
$desktop-nav-level0-item-border                 : none !default;
$desktop-nav-level0-item-color                  : $color-gray34 !default;
$desktop-nav-level0-item-text-decoration        : none !default;

$desktop-nav-level0-item-background-color-hover : inherit !default;
$desktop-nav-level0-item-border-hover           : none !default;
$desktop-nav-level0-item-color-hover            : $primary__color !default;
$desktop-nav-level0-item-text-decoration-hover  : none !default;

$desktop-nav-level0-item-background-color-active: inherit !default;
$desktop-nav-level0-item__active__border-color  : $color-orange-red1 !default;
$desktop-nav-level0-item__active__border-style  : solid !default;
$desktop-nav-level0-item__active__border-width  : 0 0 3px !default;
$desktop-nav-level0-item-color-active           : $primary__color !default;
$desktop-nav-level0-item-text-decoration-active : none !default;

$desktop-submenu-background-color               : $page__background-color !default;
$desktop-submenu-border-width                   : $border-width__base !default;
$desktop-submenu-border-style                   : solid !default;
$desktop-submenu-border-color                   : $border-color__base !default;
$desktop-submenu-box-shadow                     : 0 $indent__xs $indent__xs rgba(0, 0, 0, 0.19) !default;
$desktop-submenu-font-size                      : inherit !default;
$desktop-submenu-font-weight                    : $font-weight__bold !default;
$desktop-submenu-min-width                      : 230px !default;
$desktop-submenu-padding                        : 15px 0 !default;

$desktop-submenu-arrow                          : true !default;
$desktop-submenu-arrow-size                     : 10px !default;
$desktop-submenu-arrow-left                     : 20px !default;

$desktop-submenu-item-padding                   : 8px $indent__base !default;
$desktop-submenu-item-background-color          : inherit !default;
$desktop-submenu-item-border                    : none !default;
$desktop-submenu-item-color                     : $primary__color !default;
$desktop-submenu-item-text-decoration           : inherit !default;

$desktop-submenu-item__hover__background-color  : $secondary__color !default;
$desktop-submenu-item-border-hover              : none !default;
$desktop-submenu-item-color-hover               : $primary__color !default;
$desktop-submenu-item-text-decoration-hover     : none !default;

$desktop-submenu-item-background-color-active   : inherit !default;
$desktop-submenu-item__active__border-color     : $color-orange-red1 !default;
$desktop-submenu-item__active__border-style     : solid !default;
$desktop-submenu-item__active__border-width     : 0 0 0 3px !default;
$desktop-submenu-item-color-active              : inherit !default;
$desktop-submenu-item-text-decoration-active    : inherit !default;

@mixin lib-main-navigation-desktop(
    $_nav-background-color                   : $desktop-nav-background-color                   ,
    $_nav-border                             : $desktop-nav-border                             ,
    $_nav-font-size                          : $desktop-nav-font-size                          ,
    $_nav-font-weight                        : $desktop-nav-font-weight                        ,

    $_nav-level0-item-line-height            : $desktop-nav-level0-item-line-height            ,
    $_nav-level0-item-margin                 : $desktop-nav-level0-item-margin                 ,
    $_nav-level0-item-padding                : $desktop-nav-level0-item-padding                ,

    $_nav-level0-item-background-color       : $desktop-nav-level0-item-background-color       ,
    $_nav-level0-item-border                 : $desktop-nav-level0-item-border                 ,
    $_nav-level0-item-color                  : $desktop-nav-level0-item-color                  ,
    $_nav-level0-item-text-decoration        : $desktop-nav-level0-item-text-decoration        ,

    $_nav-level0-item-background-color-hover : $desktop-nav-level0-item-background-color-hover ,
    $_nav-level0-item-border-hover           : $desktop-nav-level0-item-border-hover           ,
    $_nav-level0-item-color-hover            : $desktop-nav-level0-item-color-hover            ,
    $_nav-level0-item-text-decoration-hover  : $desktop-nav-level0-item-text-decoration-hover  ,

    $_nav-level0-item-background-color-active: $desktop-nav-level0-item-background-color-active,
    $_nav-level0-item__active__border-color  : $desktop-nav-level0-item__active__border-color  ,
    $_nav-level0-item__active__border-style  : $desktop-nav-level0-item__active__border-style  ,
    $_nav-level0-item__active__border-width  : $desktop-nav-level0-item__active__border-width  ,
    $_nav-level0-item-color-active           : $desktop-nav-level0-item-color-active           ,
    $_nav-level0-item-text-decoration-active : $desktop-nav-level0-item-text-decoration-active ,

    $_submenu-background-color               : $desktop-submenu-background-color               ,
    $_submenu-border-width                   : $desktop-submenu-border-width                   ,
    $_submenu-border-style                   : $desktop-submenu-border-style                   ,
    $_submenu-border-color                   : $desktop-submenu-border-color                   ,
    $_submenu-box-shadow                     : $desktop-submenu-box-shadow                     ,
    $_submenu-font-size                      : $desktop-submenu-font-size                      ,
    $_submenu-font-weight                    : $desktop-submenu-font-weight                    ,
    $_submenu-min-width                      : $desktop-submenu-min-width                      ,
    $_submenu-padding                        : $desktop-submenu-padding                        ,

    $_submenu-arrow                          : $desktop-submenu-arrow                          ,
    $_submenu-arrow-size                     : $desktop-submenu-arrow-size                     ,
    $_submenu-arrow-left                     : $desktop-submenu-arrow-left                     ,

    $_submenu-item-padding                   : $desktop-submenu-item-padding                   ,
    $_submenu-item-background-color          : $desktop-submenu-item-background-color          ,
    $_submenu-item-border                    : $desktop-submenu-item-border                    ,
    $_submenu-item-color                     : $desktop-submenu-item-color                     ,
    $_submenu-item-text-decoration           : $desktop-submenu-item-text-decoration           ,

    $_submenu-item__hover__background-color  : $desktop-submenu-item__hover__background-color  ,
    $_submenu-item-border-hover              : $desktop-submenu-item-border-hover              ,
    $_submenu-item-color-hover               : $desktop-submenu-item-color-hover               ,
    $_submenu-item-text-decoration-hover     : $desktop-submenu-item-text-decoration-hover     ,

    $_submenu-item-background-color-active   : $desktop-submenu-item-background-color-active   ,
    $_submenu-item__active__border-color     : $desktop-submenu-item__active__border-color     ,
    $_submenu-item__active__border-style     : $desktop-submenu-item__active__border-style     ,
    $_submenu-item__active__border-width     : $desktop-submenu-item__active__border-width     ,
    $_submenu-item-color-active              : $desktop-submenu-item-color-active              ,
    $_submenu-item-text-decoration-active    : $desktop-submenu-item-text-decoration-active
) {

    .navigation {
        @include lib-css(background, $_nav-background-color);
        @include lib-css(border, $_nav-border);
        @include lib-css(font-size, $_nav-font-size);
        @include lib-css(font-weight, $_nav-font-weight);
        height: inherit;
        left: auto;
        overflow: inherit;
        padding: 0;
        position: relative;
        top: 0;
        width: 100%;
        z-index: 3;

        &:empty {
            display: none;
        }

        ul {
            margin-top: 0;
            margin-bottom: 0;
            padding: 0;
            position: relative;
        }

        li.level0 {
            @include lib-css(border-top, none);
        }

        .level0 {
            @include lib-css(margin, $_nav-level0-item-margin);
            display: inline-block;
            position: relative;

            &:last-child {
                margin-right: 0;
                padding-right: 0;
            }

            > .level-top {
                @include lib-css(background, $_nav-level0-item-background-color);
                @include lib-css(border, $_nav-level0-item-border);
                @include lib-css(color, $_nav-level0-item-color);
                @include lib-css(line-height, $_nav-level0-item-line-height);
                @include lib-css(padding, $_nav-level0-item-padding);
                @include lib-css(text-decoration, $_nav-level0-item-text-decoration);
                box-sizing: border-box;
                position: relative;

                &:hover,
                &.ui-state-focus {
                    @include lib-css(background, $_nav-level0-item-background-color-hover);
                    @include lib-css(border, $_nav-level0-item-border-hover);
                    @include lib-css(color, $_nav-level0-item-color-hover);
                    @include lib-css(text-decoration, $_nav-level0-item-text-decoration-hover);
                }
            }

            &.active,
            &.has-active {
                > .level-top {
                    @include lib-css(background, $_nav-level0-item-background-color-active);
                    @include lib-css(border-color, $_nav-level0-item__active__border-color);
                    @include lib-css(border-style, $_nav-level0-item__active__border-style);
                    @include lib-css(border-width, $_nav-level0-item__active__border-width);
                    @include lib-css(color, $_nav-level0-item-color-active);
                    @include lib-css(text-decoration, $_nav-level0-item-text-decoration-active);
                    display: inline-block;
                }
            }

            &.parent:hover > .submenu {
                overflow: visible !important;
            }

            .submenu {
                @include lib-css(background, $_submenu-background-color);
                @include lib-css(border, $_submenu-border-width $_submenu-border-style $_submenu-border-color);
                @include lib-css(box-shadow, $_submenu-box-shadow);
                @include lib-css(font-size, $_submenu-font-size);
                @include lib-css(font-weight, $_submenu-font-weight);
                @include lib-css(min-width, $_submenu-min-width);
                @include lib-css(padding, $_submenu-padding);
                display: none;
                left: 0;
                margin: 0 !important;
                padding: 0;
                position: absolute;
                z-index: 1;

                @include _lib-submenu-arrow(
                    $_submenu-arrow,
                    $_bg     : $_submenu-background-color,
                    $_border : $_submenu-border-color,
                    $_size   : $_submenu-arrow-size,
                    $_left   : $_submenu-arrow-left
                );

                a {
                    display: block;
                    line-height: inherit;
                    @include lib-css(background, $_submenu-item-background-color);
                    @include lib-css(border, $_submenu-item-border);
                    @include lib-css(color, $_submenu-item-color);
                    @include lib-css(padding, $_submenu-item-padding);
                    @include lib-css(text-decoration, $_submenu-item-text-decoration);

                    &:hover,
                    &.ui-state-focus {
                        @include lib-css(background, $_submenu-item__hover__background-color);
                        @include lib-css(border, $_submenu-item-border-hover);
                        @include lib-css(color, $_submenu-item-color-hover);
                        @include lib-css(text-decoration, $_submenu-item-text-decoration-hover);
                    }
                }

                .active > a {
                    @include lib-css(background, $_submenu-item-background-color-active);
                    @include lib-css(border-color, $_submenu-item__active__border-color);
                    @include lib-css(border-style, $_submenu-item__active__border-style);
                    @include lib-css(border-width, $_submenu-item__active__border-width);
                    @include lib-css(color, $_submenu-item-color-active);
                    @include lib-css(text-decoration, $_submenu-item-text-decoration-active);
                }

                .submenu {
                    top: 0 !important;
                    left: 100% !important;
                }

                .submenu-reverse {
                    left: auto !important;
                    right: 100%;
                }
            }

            &.more {
                position: relative;
                @include lib-icon-font(
                    $icon-pointer-down,
                    $_icon-font-size     : 26px,
                    $_icon-font-position : after
                );

                &:before {
                    display: none;
                }

                &:after {
                    cursor: pointer;
                    padding: 8px 12px;
                    position: relative;
                    z-index: 1;
                }

                &:hover > .submenu {
                    overflow: visible !important;
                }

                li {
                    display: block;
                }
            }
        }
    }
}

//  Submenu arrow
@mixin _lib-submenu-arrow(
    $_submenu-arrow,
    $_bg,
    $_border,
    $_size,
    $_left
){
    @if $_submenu-arrow == true {
        @if iscolor($_bg) and iscolor($_border) {
            $_outer-size: $_size + 1;
            $_outer-left: $_left - 1;
            @include lib-css(margin-top, $_outer-size);

            > ul {
                @include lib-css(margin-top, $_outer-size);

                &:before,
                &:after {
                    content: '';
                    display: block;
                    overflow: hidden;
                    position: absolute;
                }

                &:before {
                    @include lib-css(color, $_bg);
                    @include lib-css(left, $_left);
                    @include lib-css(top, -$_size*2);
                    @include lib-arrow(up, $_size, $_bg);
                    z-index: 4;
                }

                &:after {
                    @include lib-arrow(up, $_outer-size, $_border);
                    @include lib-css(color, $_border);
                    @include lib-css(left, $_outer-left);
                    @include lib-css(top, -$_outer-size*2);
                    z-index: 3;
                }
            }
        }

        @if iscolor($_bg) and iscolor($_border) == false {
            @include lib-css(margin-top, -$_size);

            > ul {
                @include lib-css(margin-top, $_size);

                &:before {
                    @include lib-arrow(up, $_size, $_bg);
                    @include lib-css(color, $_bg);
                    @include lib-css(left, $_left);
                    @include lib-css(top, -$_size*2);
                    content: '';
                    display: block;
                    overflow: hidden;
                    position: absolute;
                    z-index: 4;
                }
            }
        }

        @if iscolor($_border) and iscolor($_bg) == false {
            @include lib-css(margin-top, -$_size);

            > ul {
                @include lib-css(margin-top, $_size);

                &:before {
                    @include lib-arrow(up, $_size, $_border);
                    @include lib-css(color, $_border);
                    @include lib-css(left, $_left);
                    @include lib-css(top, -$_size*2);
                    content: '';
                    display: block;
                    overflow: hidden;
                    position: absolute;
                    z-index: 4;
                }
            }
        }
    }
}
